# Zolt zkVM Implementation TODO

## Current Status (Jolt Compatibility Phase)

**Project Status: PROOF DESERIALIZATION WORKING ✅**

### Major Milestone Achieved!
Jolt can now successfully deserialize proofs generated by Zolt!

Test output:
```
Successfully deserialized Zolt proof!
  Trace length: 8
  RAM K: 65536
  Bytecode K: 65536
  Commitments: 5
```

The following Jolt-compatibility components are now working:
- Blake2b transcript with identical Fiat-Shamir challenges
- Jolt-compatible proof types (JoltProof, SumcheckInstanceProof, etc.)
- Arkworks-compatible serialization with byte-perfect output
- Proof converter (6-stage Zolt → 7-stage Jolt)
- JoltProver with `proveJoltCompatible()` method
- Jolt proof serialization with `serializeJoltProofDory()`
- Dory commitment scheme with GT (Fp12) serialization
- **COMPLETE: Full Dory IPA proving algorithm**
- **COMPLETE: Dory proof serialization matching arkworks format**
- G1/G2 point compression in arkworks format
- End-to-end serialization tests verifying format compatibility
- **VERIFIED: Jolt can deserialize Zolt proofs**

---

## Phase 2: Jolt Compatibility

### 1. Transcript Alignment ✅ COMPLETE

- [x] **Create Blake2bTranscript** (`src/transcripts/blake2b.zig`)
- [x] **Test Vector Validation** - 7 test vectors verified

### 2. Proof Types ✅ COMPLETE

- [x] **JoltProof Structure** (`src/zkvm/jolt_types.zig`)

### 3. Serialization ✅ COMPLETE

- [x] **Arkworks-Compatible Format** (`src/zkvm/jolt_serialization.zig`)
- [x] **writeDoryProof method** - Matches ark_serde.rs format exactly
- [x] **writeG1Compressed/writeG2Compressed** - Arkworks point compression
- [x] **writeU32** - For num_rounds, nu, sigma

### 4. Dory Commitment Scheme ✅ COMPLETE

- [x] **Dory Implementation** (`src/poly/commitment/dory.zig`)
- [x] **Full Dory IPA Prover** - reduce-and-fold algorithm
- [x] **Point Compression** - G1/G2 in arkworks format
- [x] **Proof Serialization** - Matches ArkDoryProof format

### 5. Prover Wiring ✅ COMPLETE

- [x] **Proof Converter** (`src/zkvm/proof_converter.zig`)
- [x] **JoltProver Integration** (`src/zkvm/mod.zig`)
- [x] **serializeJoltProofDory()** - Generates full Dory proofs

### 6. Cross-Verification ✅ PARTIAL

- [x] **Jolt deserializes Zolt proofs** - VERIFIED WORKING
- [ ] **Jolt verifies Zolt proofs** - Next step (requires matching preprocessing)

---

## Remaining Work

### Proof Verification (Not Yet Tested)

The deserialization works, but full verification requires:
1. Matching preprocessing data between Zolt and Jolt
2. Generating proofs for the same program with same inputs
3. Using consistent SRS parameters

### Tasks

1. **Create matching test program**
   - Build same fibonacci.elf for both Zolt and Jolt
   - Save Jolt's verifier preprocessing to file
   - Generate Zolt proof using same program

2. **Verify sumcheck proofs**
   - Ensure sumcheck round polynomials match expected degrees
   - Verify opening claims are computed correctly

3. **Test full verification flow**
   - Load Jolt preprocessing
   - Deserialize Zolt proof
   - Run Jolt verifier

---

## Test Status

### All 608 Tests Passing

```
zig build test --summary all
Build Summary: 5/5 steps succeeded; 608/608 tests passed
```

### Cross-Verification Tests

| Test | Status |
|------|--------|
| `test_debug_zolt_format` | ✅ PASS - Parses claims and commitments |
| `test_deserialize_zolt_proof` | ✅ PASS - Full deserialization works |
| `test_verify_zolt_proof` | ⏳ Pending - Needs preprocessing data |

---

## Key Reference Files

### Zolt (Implemented)
| File | Status | Purpose |
|------|--------|---------|
| `src/transcripts/blake2b.zig` | ✅ Done | Blake2bTranscript + Dory helpers |
| `src/zkvm/jolt_types.zig` | ✅ Done | Jolt proof types |
| `src/zkvm/jolt_serialization.zig` | ✅ Done | Arkworks serialization + Dory proof |
| `src/zkvm/proof_converter.zig` | ✅ Done | 6→7 stage converter |
| `src/zkvm/mod.zig` | ✅ Done | JoltProver with Jolt export |
| `src/poly/commitment/dory.zig` | ✅ Done | Full Dory IPA + serialization |

### Jolt (Reference Only)
| File | Purpose |
|------|---------|
| `jolt-core/src/zolt_compat_test.rs` | ✅ Cross-verification tests |
| `dory-pcs/src/backends/arkworks/ark_serde.rs` | ✅ Dory proof format reference |

---

## Success Criteria

1. ✅ `zig build test` passes all 608 tests
2. ✅ Zolt can generate a proof in Jolt format (`proveJoltCompatible`)
3. ✅ Zolt can serialize proofs in arkworks format (`serializeJoltProofDory`)
4. ✅ Jolt can deserialize Zolt proofs (VERIFIED!)
5. ✅ Dory commitment scheme with GT serialization
6. ✅ Full Dory IPA proof structure with G1/G2 compression
7. ⏳ The proof can be verified by Jolt (requires matching preprocessing)
8. ⏳ No modifications needed on the Jolt side

## Priority Order

1. ✅ **Transcript** - Matching Fiat-Shamir complete
2. ✅ **Proof Types** - JoltProof structure defined
3. ✅ **Serialization** - Byte-perfect compatibility verified
4. ✅ **Dory Commitment** - GT serialization complete
5. ✅ **Dory IPA Proof** - Full serialization matching arkworks
6. ✅ **Cross-Deserialization** - Jolt reads Zolt proofs!
7. ⏳ **Full Verification** - Requires preprocessing alignment
