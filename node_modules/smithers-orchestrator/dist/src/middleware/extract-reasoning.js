export function extractReasoningMiddleware(options) {
    const separator = options.separator ?? '\n';
    const tagName = options.tagName;
    const tagRegex = new RegExp(`<${tagName}>([\\s\\S]*?)</${tagName}>`, 'gi');
    return {
        name: 'extractReasoning',
        transformResult: (result) => {
            const matches = [];
            const output = result.output.replace(tagRegex, (_, content) => {
                matches.push(content.trim());
                return '';
            });
            if (matches.length === 0) {
                return result;
            }
            const reasoning = matches.join(separator).trim();
            const cleanedOutput = options.startWithReasoning ? output.trimStart() : output.trim();
            options.onReasoning?.(reasoning);
            return {
                ...result,
                reasoning,
                output: cleanedOutput,
            };
        },
    };
}
//# sourceMappingURL=extract-reasoning.js.map