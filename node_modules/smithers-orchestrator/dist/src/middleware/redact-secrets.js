const DEFAULT_PATTERNS = [
    /sk-[a-zA-Z0-9]{48}/g,
    /-----BEGIN [A-Z ]+-----[\s\S]+?-----END [A-Z ]+-----/g,
    /[a-zA-Z0-9+/]{40,}={0,2}/g,
];
export function redactSecretsMiddleware(options = {}) {
    const patterns = options.patterns ?? DEFAULT_PATTERNS;
    const replacement = options.replacement ?? '***REDACTED***';
    const redact = (input) => {
        let next = input;
        for (const pattern of patterns) {
            next = next.replace(pattern, replacement);
        }
        return next;
    };
    return {
        name: 'redact-secrets',
        transformChunk: redact,
        transformResult: (result) => {
            const output = redact(result.output);
            return {
                ...result,
                output,
                ...(result.reasoning !== undefined ? { reasoning: redact(result.reasoning) } : {}),
            };
        },
    };
}
//# sourceMappingURL=redact-secrets.js.map