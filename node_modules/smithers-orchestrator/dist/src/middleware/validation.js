export class ValidationError extends Error {
    constructor(message) {
        super(message);
        this.name = 'ValidationError';
    }
}
export function validationMiddleware(options) {
    return {
        name: 'validation',
        // Use wrapExecute instead of transformResult so validation errors
        // can be caught by retry middleware (which also uses wrapExecute)
        wrapExecute: async ({ doExecute }) => {
            const result = await doExecute();
            if (result.stopReason === 'error') {
                return result;
            }
            const isValid = await options.validate(result);
            if (!isValid) {
                throw new ValidationError(options.errorMessage ?? 'Validation failed');
            }
            return result;
        },
    };
}
//# sourceMappingURL=validation.js.map