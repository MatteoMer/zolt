/**
 * Shared utilities for reactive SQLite hooks
 */
import { useRef, useCallback, useSyncExternalStore } from 'react';
/**
 * Hook for a simple in-memory signal store.
 * Allows manual invalidation without useState.
 */
export function useStoreSignal() {
    const listenersRef = useRef(new Set());
    const subscribe = useCallback((listener) => {
        listenersRef.current.add(listener);
        return () => {
            listenersRef.current.delete(listener);
        };
    }, []);
    const notify = useCallback(() => {
        for (const listener of listenersRef.current) {
            listener();
        }
    }, []);
    return { subscribe, notify };
}
/**
 * Hook for version tracking to force re-renders without useState.
 */
export function useVersionTracking() {
    const versionRef = useRef(0);
    const updateRef = useRef(0);
    const { subscribe, notify } = useStoreSignal();
    useSyncExternalStore(subscribe, () => updateRef.current, () => updateRef.current);
    const incrementVersion = useCallback(() => {
        versionRef.current += 1;
    }, []);
    const invalidateAndUpdate = useCallback(() => {
        updateRef.current += 1;
        notify();
    }, [notify]);
    return {
        versionRef,
        incrementVersion,
        invalidateAndUpdate,
    };
}
/**
 * Hook for managing query cache
 */
export function useQueryCache() {
    const cacheRef = useRef(null);
    const invalidateCache = useCallback(() => {
        cacheRef.current = null;
    }, []);
    const updateCache = useCallback((key, data, error) => {
        cacheRef.current = { key, data, error };
    }, []);
    return {
        cacheRef,
        invalidateCache,
        updateCache,
    };
}
//# sourceMappingURL=shared.js.map