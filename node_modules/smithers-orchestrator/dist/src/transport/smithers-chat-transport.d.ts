import { type ReactNode } from 'react';
import { type SmithersDB } from '../db/index.js';
import { type SmithersConfig } from '../components/SmithersProvider.js';
import type { ChatTransport, ChatTransportSendOptions, ChatTransportReconnectOptions, SmithersChunk, SmithersMessage, SmithersTable } from './types.js';
export interface SmithersOrchestrationContext {
    chatId: string;
    executionId: string;
    db: SmithersDB;
    messages: SmithersMessage[];
    trigger: ChatTransportSendOptions<SmithersMessage>['trigger'];
}
export type SmithersOrchestration = ReactNode | ((context: SmithersOrchestrationContext) => ReactNode | Promise<ReactNode>);
export interface SmithersChatTransportOptions {
    /**
     * Orchestration component, factory, or module path.
     */
    orchestration: SmithersOrchestration | string;
    /**
     * Database path. Use '{chatId}' to create per-chat databases.
     */
    dbPath?: string;
    /**
     * Smithers configuration passed to SmithersProvider and execution config.
     */
    config?: SmithersConfig;
    /**
     * Execution name override.
     */
    executionName?: string;
    /**
     * Execution file path override when orchestration is not a path.
     */
    executionFilePath?: string;
    /**
     * Tables to stream (defaults to all Smithers tables).
     */
    tables?: SmithersTable[];
}
export declare class SmithersChatTransport implements ChatTransport<SmithersMessage, SmithersChunk> {
    private options;
    private sessions;
    private singleChatId;
    constructor(options: SmithersChatTransportOptions);
    sendMessages(options: ChatTransportSendOptions<SmithersMessage>): Promise<ReadableStream<SmithersChunk>>;
    reconnectToStream(options: ChatTransportReconnectOptions): Promise<ReadableStream<SmithersChunk> | null>;
    private getOrCreateSession;
    private attachAbort;
    private persistMessages;
    private startSessionIfNeeded;
    private closeIfComplete;
    private broadcastStatus;
    private createStream;
    private loadSessionFromDisk;
}
//# sourceMappingURL=smithers-chat-transport.d.ts.map